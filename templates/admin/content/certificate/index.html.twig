{% extends 'admin/base.html.twig' %}

{% block head_stylesheets %}
    {{ parent() }}
    <link href="{{
        asset('assets/bundles/volgh/BS5-HTML/HTML/volgh/assets/plugins/datatable/css/dataTables.bootstrap5.min.css')
        }}"
        type="text/css" rel="stylesheet"/>
    <link href="{{
        asset('assets/bundles/volgh/BS5-HTML/HTML/volgh/assets/plugins/notify/css/jquery.growl.css') }}"
        type="text/css" rel="stylesheet"/>
    <link href="{{ asset('assets/app/css/certificateUploadModal.css') }}" type="text/css" rel="stylesheet"/>

{% endblock %}

{% block content %}

    <div class="page-header">

        <div><h1 class="page-title">Certificates</h1>
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="#">Admin</a></li>
                <li class="breadcrumb-item active" aria-current="page">Certificates</li>
            </ol>
        </div>

        {% include 'admin/page/pageheader.html.twig' %}

    </div>

    <div class="row">
        <div class="col-md-12 col-lg-12">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Certificates</h3>
                    <div class="position-absolute top-1 end-0 pe-3">
                        <button id="certificateModal" type="submit" class="btn btn-success" data-toggle="modal"
                                data-target="#exampleModal">
                            {{ 'Add Certificate'|trans }}
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table id="table_id" class="table table-striped table-bordered text-nowrap w-100" >
                            <thead>
                            <tr>
                                <th>{{ 'Partner Id'|trans }}</th>
                                <th>{{ 'Email'|trans }}</th>
                                <th>{{ 'Type'|trans }}</th>
                                <th>{{ 'Certificate Expiration'|trans }}</th>
                                <th>{{ 'Valid From'|trans }}</th>
                                <th>{{ 'Valid Until'|trans }}</th>
                                <th>{{ 'Organization'|trans }}</th>
                                <th>{{ 'Type MarketPartner'|trans }}</th>
                                <th>{{ 'Energy'|trans }}</th>
                                <th>{{ 'Active'|trans }}</th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for marketPartnerEmail in marketPartnerEmails %}
                                <tr>
                                    <td>{{ marketPartnerEmail.marketPartner.id }}</td>
                                    <td>{{ marketPartnerEmail.email }}</td>
                                    <td>{{ marketPartnerEmail.type }}</td>
                                    <td>{{ marketPartnerEmail.sslCertificateExpiration|date('Y-m-d') }}</td>
                                    <td>{{ marketPartnerEmail.activeFrom|date('Y-m-d') }}</td>
                                    <td>{{ marketPartnerEmail.activeUntil|date('Y-m-d') }}</td>
                                    <td>{{ marketPartnerEmail.marketPartner.organization }}</td>
                                    <td>{{ marketPartnerEmail.marketPartner.type }}</td>
                                    <td>{{ marketPartnerEmail.marketPartner.energy }}</td>
                                    {% if (marketPartnerEmail.activeFrom|date('Y-m-d') <= nowDate) and
                                          (marketPartnerEmail.activeUntil >= nowDate) %}
                                        <td><div class="badge bg-success">{{ 'Active'|trans }}</div></td>
                                    {% else %}
                                        <td><div class="badge bg-danger"> {{ 'Inactive'|trans }}</div></td>
                                    {% endif %}
                                </tr>
                            {% endfor %}
                            </tbody>
                        </table>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <input id="showSuccessMessage" type="hidden" value="{{showSuccess}}" />

    {% include 'admin/content/certificate/certificateUploadModal.html.twig' %}

{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script defer src="{{
        asset('assets/bundles/volgh/BS5-HTML/HTML/volgh/assets/plugins/datatable/js/jquery.dataTables.min.js') }}">
    </script>
    <script defer src="{{
        asset('assets/bundles/volgh/BS5-HTML/HTML/volgh/assets/plugins/datatable/js/dataTables.bootstrap5.min.js') }}">
    </script>
    <script defer src="{{
        asset('assets/bundles/volgh/BS5-HTML/HTML/volgh/assets/plugins/datatable/dataTables.responsive.min.js') }}">
    </script>
    <script defer src="{{
    asset('assets/bundles/volgh/BS5-HTML/HTML/volgh/assets/plugins/notify/js/rainbow.js') }}">
    </script>
    <script defer src="{{
    asset('assets/bundles/volgh/BS5-HTML/HTML/volgh/assets/plugins/notify/js/jquery.growl.js') }}">
    </script>
    <script defer src="{{ asset('assets/app/js/certificate.js') }}"></script>
{% endblock %}
